#he zyieo.github.io

关于家用nas的一点思考

目前的家用解决方案都是照抄企业级方案，专注于技术实现，对总体方案规划有所不足。


因为nas包含的各种应用，实际上各自的最优解决方案的需求是彼此冲突的。
1、文件共享，只在工作时间要求有，并且本身也是分级，有些可以通过离线存档。对速度要求没有硬限制，当然越高越好。方便性有一定要求。
2、同步，区分日常需要人参与型的与偶尔需求。前者使用时开机，数据盘长期在线。后者利用工作机辅助，数据盘偶尔挂载。当然实现的时候互为AB角色 —— 双方功能都提供，但是性能有区别。
3、照片功能，要求方便性，对主机性能有很大的要求，偶尔性需求，对功耗限制不大。
4、


使用场景：
1、长期在线的部分功能，如数据下载， 简单的数据、照片存储； —— A机
2、有人参与的情况下，使用的全功能的nas服务； —— B机
3、周期性或者偶尔情况下， 离线保存重要数据，作为AB机的补充。其离线硬盘可以随时取下。 —— C机

总体方案：
简单地说，轻重搭配的方案，把需要长期在线、维护的工具放在轻型机/低功耗机A上，人在才需要的服务放在日常正常开关机的重型机/普通nas机B上，配合自动脚本进行开机后数据维护。偶尔需要的服务放在工作机上，如工作站，其数据盘可随时离线，保证安全。
ABC三机出于同一Lan下，组成nas机群。
实质上是把主流nas方案里的docker退化为物理机，并提供不对称冗余。

工作站C机一般作为客户机， 只对偶尔应用的服务提供支援，比如数据离线备份、

在配置上，
A： A机使用树莓派、香橙派、机顶盒、电视盒、n1、玩客云之类超低功耗目标机，配合各种变形linux，主要是为支持下载BT，使用一个外挂的u盘作为下载存储空间；以及轻小的文件服务，避免每次都开通B机。最小限度地实现nas功能，主要目标是提供长期在线的便利。性能未必合适。
这是在功耗噪音vs性能方面做的一点取舍选择。

AB机之间协作的方式是B机开通后，使用自动化脚本更新至B机。
更进一步，可以考虑由A机控制B机的启停。

输入：
下载工具bt等客户端
小规模的照片、文件服务器，用于临时、轻小的服务；


输出：
开通smb等文件共享服务。

B：
B机在功耗上要求虽然有所降低，更多考虑足够的性能，但并非主力工作用机。考虑到应用场景，可以使用固态硬盘加速启动降低等待时间，以弥补非长期在线带来的时间延迟。
如果能远程控制B机启停则更佳。
系统与主要服务放在ssd盘上，如果使用紧凑机型，则考虑外挂机械盘作为数据存储主空间。

#he zyieo.github.io

https://hamradio.my/2024/05/setting-up-a-network-attached-storage-nas-using-ubuntu-at-home/


